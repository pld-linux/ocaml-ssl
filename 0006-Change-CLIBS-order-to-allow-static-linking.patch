From 19de50eae439507f75d4491e4b8608ee3ac4caf3 Mon Sep 17 00:00:00 2001
From: Samuel Mimram <smimram@gmail.com>
Date: Thu, 3 Nov 2016 16:58:03 +0100
Subject: [PATCH 6/6] Change CLIBS order to allow static linking

Fixes #27.
---
 CHANGES         | 1 +
 src/Makefile.in | 4 ++--
 src/ssl_stubs.c | 2 --
 3 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/CHANGES b/CHANGES
index 87bd915..9f1ef84 100644
--- a/CHANGES
+++ b/CHANGES
@@ -2,6 +2,7 @@
 =====
 * Remove -ansi flag to be compatible with OCaml 4.04 (thanks Mark Shinwell).
 * Use accessor functions for X509_STORE_CTX.
+* Change CLIBS order to allow static linking.
 
 0.5.2 (2015-11-23)
 =====
diff --git a/src/Makefile.in b/src/Makefile.in
index c0edfc6..843885e 100644
--- a/src/Makefile.in
+++ b/src/Makefile.in
@@ -25,9 +25,9 @@ export LIBINSTALL_FILES = $(wildcard *.mli *.cmi *.cma *.cmxa *.cmx *$(shell oca
 export OCAMLLDFLAGS =
 export OCAMLDOCFLAGS = -stars
 ifeq (1, $(shell uname -s | grep -c "MINGW"))
-	export CLIBS = crypto ssl ws2_32 gdi32 crypt32
+	export CLIBS = ssl crypto ws2_32 gdi32 crypt32
 else
-	export CLIBS = crypto ssl
+	export CLIBS = ssl crypto
 endif
 export CC = @CC@
 export CFLAGS = @CFLAGS@ -DCAML_NAME_SPACE -Wall
diff --git a/src/ssl_stubs.c b/src/ssl_stubs.c
index e131527..fa4cbbf 100644
--- a/src/ssl_stubs.c
+++ b/src/ssl_stubs.c
@@ -24,8 +24,6 @@
  * @author Samuel Mimram
  */
 
-/* $Id$ */
-
 /*
  * WARNING: because of thread callbacks, all ssl functions should be in
  * blocking sections.
-- 
2.9.3

